<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="fonts/iconfont.css"/>
    <link rel="stylesheet" href="css/ccKit.css"/>
    <link rel="stylesheet" href="css/admin.css"/>
    <link rel="stylesheet" href="js/lightbox/wiget.lightbox.css"/>
    <title>图片管理</title>
</head>
<body>

<div class="c-menu">

    <div class="c-dt">我的相册</div>
    <div class="c-add-pic">
        <button>新建相册</button>
    </div>
    <div class="c-menu-btn iconfont">&#xe644;</div>
    <div class="c-close-btn iconfont">
        &#xe60d;
    </div>
    <ul class="c-classes  js-album">
    </ul>

</div>

<div class="c-content">
    <ul class="c-pic-list">

    </ul>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/main.js"></script>
<script>

    (function($){

        var _this    = $('.c-menu'),
            menuBtn  = _this.find('.c-menu-btn'),
            closeBtn = _this.find('.c-close-btn'),
            classes  = _this.find('.c-classes');

        menuBtn.click(function(){
            _this.addClass('open');
        });
        closeBtn.click(function(){
            _this.removeClass('open');
        });

      classes.on('click','li',function(){
        $(this).addClass('active').siblings('.active').removeClass('active');
                closeBtn.trigger('click');
      });
//        classes.find('>li').each(function(index, element){
//            $(element).click(function(){
//                $(this).addClass('active').siblings().removeClass('active');
//                closeBtn.trigger('click');
//            });
//        })

    })(jQuery);


    (function ($) {

        var _this, li, moreBtn;
        _this   = $('.c-pic-list');

        //渲染图片
        $.ajax('http://127.0.0.1:8881/imgList?page=1')
                .success(function (response) {
                    response.forEach(function (element, index) {
                        var html = '<li draggable="true">'+
                                '            <div class="c-image-box">'+
                                '                <div class="c-image">'+
                                '                    <div class="c-layer">'+
                                '                        <img src="'+element.url+'" alt=""/>'+
                                '                    </div>'+
                                '                    <div'+
                                '                          data-role="lightbox"'+
                                '                          data-source="'+element.url+'"'+
                                '                          data-group="group-1"'+
                                '                          data-id="kojji"'+
                                '                          data-caption="发了看得见啊" class="c-mask js-lightbox">'+
                                '                        <div class="c-mask-layer ">'+
                                '                            <div class="iconfont c-eye">'+
                                '                                &#xe65e;'+
                                '                            </div>'+
                                '                        </div>'+
                                '                    </div>'+
                                '                </div>'+
                                '                <div class="c-title">'+
                                '                    武器大师，贾克斯'+
                                '                    <div class="c-more cc-right ">'+
                                '                        <span class="iconfont">&#xe626;</span>'+
                                '                        <div class="c-polygon c-polygon-border"></div>'+
                                '                        <div class="c-polygon"></div>'+
                                '                        <ul class="c-more-sub">'+
                                '                            <li>编辑</li>'+
                                '                            <li>移动</li>'+
                                '                            <li>删除</li>'+
                                '                            <li class="c-close iconfont">&#xe60d;</li>'+
                                '                        </ul>'+
                                '                    </div>'+
                                '                </div>'+
                                '            </div>'+
                                '        </li>';
                        _this.append(html);
                    });
                    li      = _this.find('>li');
                    moreBtn = li.find('.c-more');

                    moreBtn.click(function(){
                        $(this).toggleClass('active');
                    });

                    _this.drag(function(start,end){
                        var _temp = li.eq(start);
                        li.eq(start).remove();
                        li.eq(end).before(_temp);
                        li = _this.find('>li');

                        _this.Masonry(3);
                    });

                    setTimeout(function () {
                        _this.Masonry(3);
                    },500)
                });

        $.ajax('/imgClasses').success(function (response) {
            response.forEach(function (element, index) {
                $('.c-classes').append('<li><a href="admin.html?c='+element+'">'+element+'</a></li>');
            })
        })




    })(jQuery);

</script>
<script type="text/javascript" src="js/utility.drag.js"></script>
<script type="text/javascript" src="js/admin.js"></script>
<script type="text/javascript" src="js/admin.album.js"></script>
<script type="text/javascript" src="js/widget.js"></script>
<script type="text/javascript" src="js/lightbox/wiget.lightbox.js"></script>
<script>
    $(function(){
        admin.initModule($('.js-album'));
        var lightbox=new widget.LightBox();
    });
</script>
</body>
</html>